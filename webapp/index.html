<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lavander Shop</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
  <header>
    <h1>Lavander Shop üõí</h1>
    <p>–ú–∞–≥–∞–∑–∏–Ω –ø–æ—Å—Ç–µ–ª—å–Ω–æ–≥–æ –±–µ–ª—å—è</p>
  </header>

  <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ -->
  <main>
    <div id="products-container">
      <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–¥–µ—Å—å —á–µ—Ä–µ–∑ JS -->
    </div>
  </main>

  <!-- –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å -->
  <footer>
    <p>¬© 2025 Lavander Shop</p>
  </footer>

  <script>
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤
    async function loadProducts() {
      try {
        const response = await fetch('/api/products');
        const products = await response.json();

        const productsContainer = document.getElementById('products-container');
        productsContainer.innerHTML = ''; // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

        if (products.length === 0) {
          productsContainer.innerHTML = `
            <div class="product-card col-span-2 text-center py-4">
              <p>–¢–æ–≤–∞—Ä–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç üòî</p>
            </div>
          `;
          return;
        }

        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã
        products.forEach(product => {
          const productCard = document.createElement('div');
          productCard.className = 'product-card';
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ image_url –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ñ–æ—Ç–æ –∏–ª–∏ –∑–∞–≥–ª—É—à–∫—É
          const imageSrc = product.image_url ? product.image_url : '';
          const imageContent = imageSrc
            ? `<img src="${imageSrc}" alt="${product.name}" class="product-image">`
            : `<div class="product-image-placeholder"><span>üì∑ –ù–µ—Ç —Ñ–æ—Ç–æ</span></div>`;
          productCard.innerHTML = `
            ${imageContent}
            <h3 class="product-title">${product.name}</h3>
            <p class="product-description">${product.description || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è'}</p>
            <p class="product-price">${product.price} –≥—Ä–Ω</p>
            <p class="product-stock">–û—Å—Ç–∞—Ç–æ–∫: ${product.stock}</p>
            <button class="product-button">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
          `;
          productsContainer.appendChild(productCard);
        });
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤:', error);
        document.getElementById('products-container').innerHTML = `
          <div class="product-card col-span-2 text-center text-red-600 py-4">
            <p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤: ${error.message}</p>
          </div>
        `;
      }
    }

    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–≤–∞—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    window.onload = loadProducts;
  </script>
</body>
</html>